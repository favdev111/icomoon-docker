#!/usr/bin/env ruby

$:.unshift File.join(File.dirname(__FILE__), *%w[.. lib])

require 'optparse'
require 'jekyll'

opts = OptionParser.new do |opts|
  opts.banner = DATA.read

  opts.on("--auto", "Auto-regenerate") do
    options[:auto] = true
  end
end

opts.parse!

def clean(dest)
  FileUtils.rm_rf(dest)
  FileUtils.mkdir_p(dest)
end

def globs
  
end

source = nil
destination = nil

case ARGV.size
  when 0
    source = '.'
    destination = File.join('.', '_site')
  when 1
    source = '.'
    destination = ARGV[0]
  when 2
    source = ARGV[0]
    destination = ARGV[1]
  else
    puts "Invalid options. Run `jekyll --help` for assistance."
    exit(1)
end

Jekyll.process(source, destination)

__END__
Jekyll is a blog-aware, static site generator.

Basic Command Line Usage:
  jekyll                                                   # . -> ./_site
  jekyll <path to write generated site>                    # . -> <path>
  jekyll <path to source> <path to write generated site>   # <path> -> <path>
    
  Options: